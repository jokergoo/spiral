<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Real World Examples • spiralize</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Real World Examples">
<meta property="og:description" content="spiralize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">spiralize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Vignettes</li>
    <li>
      <a href="../articles/spiralize_intro.html">Visualize Data on Spirals</a>
    </li>
    <li>
      <a href="../articles/special_data_type.html">Initialize Spirals by Special Data Types</a>
    </li>
    <li>
      <a href="../articles/annotate.html">Annotate the Plot</a>
    </li>
    <li>
      <a href="../articles/examples.html">Real World Examples</a>
    </li>
    <li>
      <a href="../articles/tree_of_life.html">Visualize tree of life</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">More applications</li>
    <li>
      <a href="../articles/spiralize_git_commit.html">Spiral visualization on git commits of a git repo</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/spiralize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Real World Examples</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-02-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/spiralize/blob/HEAD/vignettes/examples.Rmd" class="external-link"><code>vignettes/examples.Rmd</code></a></small>
      <div class="hidden name"><code>examples.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="daily-downloads-of-ggplot2">Daily downloads of ggplot2<a class="anchor" aria-label="anchor" href="#daily-downloads-of-ggplot2"></a>
</h2>
<p>In previous vignettes, I have already demonstrated the visualization of daily downloads of <strong>ggplot</strong> package. Here I make a more complete plot where I also add text annotations and legends. As I mentioned in previous vignettes, the plot visualizes log2-difference of the daily downloads to the mean downloads of the current year, which is calculated as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/spiralize" class="external-link">spiralize</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize" class="external-link">circlize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ggplot2_downloads.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">day_diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"days"</span><span class="op">)</span></span>
<span><span class="va">year_mean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">count</span>, <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">count</span><span class="op">/</span><span class="va">year_mean</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">q</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span>, <span class="fl">0.99</span><span class="op">)</span>  <span class="co"># adjust outliers</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&gt;</span> <span class="va">q</span><span class="op">]</span> <span class="op">=</span> <span class="va">q</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">diff</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;</span> <span class="op">-</span><span class="va">q</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="va">q</span></span></code></pre></div>
<p>The downloads have weekly patterns, i.e. there are less downloads in the weekends, thus in the spiral plot, I set the period as 52 weeks so that the same week in different years can be aligned in the radical direction. Now since each loop does not correspond a complete year, I additionally add annotation lines to show years.</p>
<p>The polar coordiante system is split into 12 parts where each part corresponds to a month.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 'unit_to_axis' is set to 'days'.</span></span>
<span><span class="co">## 'period' is set to 'years'.</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span>, <span class="va">df</span><span class="op">$</span><span class="va">diff</span>, use_bars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"start"</span>,      <span class="st">"2015-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2016-01-01"</span>, <span class="st">"2016-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2017-01-01"</span>, <span class="st">"2017-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2018-01-01"</span>, <span class="st">"2018-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2019-01-01"</span>, <span class="st">"2019-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-12-31"</span>, type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_highlight.html">spiral_highlight</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>, <span class="st">"end"</span>,        type <span class="op">=</span> <span class="st">"line"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="../reference/current_spiral.html">current_spiral</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">360</span>, by <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">360</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">foo</span> <span class="op">=</span> <span class="fu"><a href="../reference/polar_to_cartesian.html">polar_to_cartesian</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">/</span><span class="fl">180</span><span class="op">*</span><span class="va">pi</span>, <span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">max_radius</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fl">1.05</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid.text</a></span><span class="op">(</span><span class="va">month.name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, x <span class="op">=</span> <span class="va">foo</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">foo</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, default.unit <span class="op">=</span> <span class="st">"native"</span>,</span>
<span>        rot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">180</span>, <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="fl">90</span>, <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fl">90</span><span class="op">)</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html" class="external-link">packLegend</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Difference to\nyearly average"</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"higher"</span>, <span class="st">"lower"</span><span class="op">)</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#D73027"</span>, <span class="st">"#313695"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Year"</span>, type <span class="op">=</span> <span class="st">"lines"</span>, at <span class="op">=</span> <span class="fl">2015</span><span class="op">:</span><span class="fl">2021</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;"></p>
<p>In the plot, I think there are the following messages that we can read:</p>
<ol style="list-style-type: decimal">
<li>There are less downloads at weekends compared to weekdays.</li>
<li>There are less downloads at the end of December and in Juanuary and Feburary.</li>
<li>The downloads are also less in July and August, but not as few as winters.</li>
<li>There are the highest number of downloads in November.</li>
</ol>
</div>
<div class="section level2">
<h2 id="classification-of-central-nervous-system-tumors">Classification of central nervous system tumors<a class="anchor" aria-label="anchor" href="#classification-of-central-nervous-system-tumors"></a>
</h2>
<p><a href="https://www.nature.com/articles/nature26000" class="external-link">Capper et. al., 2018</a> studied subtype classification of central nervous system tumors from DNA methylation data. In their dataset, there are 14 different tumor types (include controls) which are classified into 91 subtypes inferred from 2801 samples.</p>
<p>The most straightforward way is to visualize it as a heatmap which is composed by a list of rectangles.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CNS_tumour_classification.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">meth_col</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">tumor_col</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>        facing <span class="op">=</span> <span class="st">"curved_inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The plot already looks good. However, one problem of that plot is I actually drawed 2801x2 rectangles, which might results in that you can observe “interference wave lines” in the plot. This is because rectangles on spirals are not real rectangles while polygons and edges of the neighbouring polygons cannot perfectly match.</p>
<p>In the previous code where I draw the text of tumor types, I used <code><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle()</a></code> function to group the tumor types. Actually we can also use it for the heatmap because tumor types and methylation classes are already sorted and grouped, so that we don’t need to draw every single rectangle for every sample in a class, which we just draw one rectangle that covers all samples in that class.</p>
<p>In the following code, I first define a function <code>spiral_rle()</code> for this purpose. This function draws rectangles and adds labels on them.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spiral_rle</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">col</span>, <span class="va">labels</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># in case it is a factor</span></span>
<span>    <span class="va">r1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rle.html" class="external-link">rle</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">labels</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">r1</span><span class="op">$</span><span class="va">lengths</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">0.5</span>, <span class="va">r1</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                facing <span class="op">=</span> <span class="st">"curved_inside"</span>, nice_facing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>I apply <code>spiral_rle()</code> to both tumor type track and methylation class track. Now the plot looks nicer. I also add legends for methylation classes, grouped by tumor types.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span>, </span>
<span>    vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">meth_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_class</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">spiral_rle</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_class</span>, col <span class="op">=</span> <span class="va">meth_col</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="va">tumor_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_col</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">spiral_rle</span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span>, col <span class="op">=</span> <span class="va">tumor_col</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, <span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span>, <span class="kw">function</span><span class="op">(</span><span class="va">ind</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">tumor_type</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_class</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span>,</span>
<span>        legend_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">meth_col</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># here set max_height to the height of the image so that the legends are automatically arranged</span></span>
<span><span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html" class="external-link">packLegend</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">lgd_list</span>, max_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">7</span>, <span class="st">"inch"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-6-1.png" width="1248" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="first-5000-digits-of-π">First 5000 digits of π<a class="anchor" aria-label="anchor" href="#first-5000-digits-of-%CF%80"></a>
</h2>
<p>This example visualizes the first 5000 digits of π. The digits of π is from <a href="https://www.math.utah.edu/~alfeld/math/pi.html" class="external-link uri">https://www.math.utah.edu/~alfeld/math/pi.html</a>.</p>
<p>The following code first formats the π digits as a vector of integers.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pi_txt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"pi_10000_digits.txt"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pi_txt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\s"</span>, <span class="st">""</span>, <span class="va">pi_txt</span><span class="op">)</span></span>
<span><span class="va">pi_digits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">pi_txt</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">pi_digits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">pi_digits</span><span class="op">)</span></span>
<span><span class="va">pi_digits</span> <span class="op">=</span> <span class="va">pi_digits</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pi_digits</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1 4 1 5 9 2</span></span></code></pre>
<p>Then each digit is assigned to a color and the point size changes according to the value of the corresponding digit.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># There are 30 loops in the spiral</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5000</span><span class="op">)</span>, end <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">30</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, pch <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="op">(</span><span class="va">pi_digits</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span>, <span class="st">"mm"</span><span class="op">)</span>, </span>
<span>    gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">pi_digits</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The next plot shows another way to visualize π. In the plot, two neighbour digits of 1 are connected, e.g. a segment connects the first and the second 1, then a second segment connects the third and the fourth 1, and so on. The segments are assigned with random colors.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5000</span><span class="op">)</span>, end <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">30</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pi_digits</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">x2</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="va">x2</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.5</span>, </span>
<span>    gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/rand_color.html" class="external-link">rand_color</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0.5</span>, max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="tree-of-life">Tree of life<a class="anchor" aria-label="anchor" href="#tree-of-life"></a>
</h2>
<p>This example visualizes tree of life from 3738 mammal organisms. The data is from <a href="http://www.biodiversitycenter.org/ttol" class="external-link">Hedges et. al., 2015</a>.</p>
<p>To highlight different branches, I first convert the <code>phylo</code> object into a <code>dendrogram</code> object, then I apply <code><a href="http://talgalili.github.io/dendextend/reference/color_branches.html" class="external-link">dendextend::color_branches()</a></code> to color branches.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"8.TTOL_mammals_unsmoothed.nwk"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dend</span> <span class="op">=</span> <span class="fu"><a href="../reference/phylo_to_dendrogram.html">phylo_to_dendrogram</a></span><span class="op">(</span><span class="va">tree</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># the log-transformation is log10(x + 1)</span></span>
<span></span>
<span><span class="va">at1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">at2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">at1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/dend_heights.html" class="external-link">dend_heights</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_yaxis.html">spiral_yaxis</a></span><span class="op">(</span>at <span class="op">=</span> <span class="va">at2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">at1</span>, <span class="st">"myr"</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#EEEEEE"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#DDDDDD"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#CCCCCC"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">at2</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">TRACK_META</span><span class="op">$</span><span class="va">ylim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#BBBBBB"</span>, col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://talgalili.github.io/dendextend/" class="external-link">dendextend</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span>
<span><span class="co"># note cutting by h is much faster than k for large dendrogram</span></span>
<span><span class="va">dend</span> <span class="op">=</span> <span class="fu"><a href="http://talgalili.github.io/dendextend/reference/color_branches.html" class="external-link">color_branches</a></span><span class="op">(</span><span class="va">dend</span>, h <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fl">70</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">rand_color</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_dendrogram.html">spiral_dendrogram</a></span><span class="op">(</span><span class="va">dend</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;"></p>
<p>It is also possible to directly use <code><a href="../reference/spiral_phylo.html">spiral_phylo()</a></code>, setting the argument <code>group</code> will also color the branches.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, scale_by <span class="op">=</span> <span class="st">"curve_length"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="fu">dendextend</span><span class="fu">::</span><span class="fu">cutree</span><span class="op">(</span><span class="va">dend</span>, h <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span><span class="va">n_cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/rand_color.html" class="external-link">rand_color</a></span><span class="op">(</span><span class="va">n_cl</span>, luminosity <span class="op">=</span> <span class="st">"bright"</span>, transparency <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_phylo.html">spiral_phylo</a></span><span class="op">(</span><span class="va">tree</span>, group <span class="op">=</span> <span class="va">col</span>, group_col <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="global-temperature-change">Global temperature change<a class="anchor" aria-label="anchor" href="#global-temperature-change"></a>
</h2>
<p>This example visualizes the global temperature change (relative to a base line) since year 1880. The data is download from <a href="https://datahub.io/core/global-temp" class="external-link uri">https://datahub.io/core/global-temp</a>. The temperature data has two sources. In the example code, I use the data from “GCAG”. In the spiral, each loop contains 20 years.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"global_temperature.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">Source</span> <span class="op">==</span> <span class="st">"GCAG"</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Date</span><span class="op">)</span>, unit_on_axis <span class="op">=</span> <span class="st">"months"</span>, period <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>    period_per_loop <span class="op">=</span> <span class="fl">20</span>, polar_lines_by <span class="op">=</span> <span class="fl">360</span><span class="op">/</span><span class="fl">20</span>, vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Date</span>, <span class="va">df</span><span class="op">$</span><span class="va">Mean</span>, use_bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1880-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1880"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1900-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1900"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1920-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1920"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1940-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1940"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1960-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1960"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"1980-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"1980"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="st">"2000-01-01"</span>, <span class="fl">0.5</span>, <span class="st">"2000"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="../reference/horizon_legend.html">horizon_legend</a></span><span class="op">(</span><span class="va">lt</span>, title <span class="op">=</span> <span class="st">"Temperature difference"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-12-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="sunspot-cycle">Sunspot cycle<a class="anchor" aria-label="anchor" href="#sunspot-cycle"></a>
</h2>
<p>This example visualizes the sunspot cycles start from year 1749. The activity of sunspot has an average period of 11 years, thus in the spiral, each loop contains 11 years. The data is from <a href="http://sidc.be/silso/datafiles" class="external-link uri">http://sidc.be/silso/datafiles</a> and the plot tries to reproduce <a href="http://www.astrostatistics.org/projects/solar-cycle" class="external-link uri">http://www.astrostatistics.org/projects/solar-cycle</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sunspot.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span>, <span class="va">df</span><span class="op">$</span><span class="va">month</span>, <span class="st">"1"</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, unit_on_axis <span class="op">=</span> <span class="st">"months"</span>, period <span class="op">=</span> <span class="st">"years"</span>, period_per_loop <span class="op">=</span> <span class="fl">11</span>, </span>
<span>    polar_lines_by <span class="op">=</span> <span class="fl">360</span><span class="op">/</span><span class="fl">11</span>, vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">col_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sunspot_number</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">sunspot_number</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">df</span><span class="op">$</span><span class="va">sunspot_number</span>, use_bar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="../reference/horizon_legend.html">horizon_legend</a></span><span class="op">(</span><span class="va">lt</span>, title <span class="op">=</span> <span class="st">"Sunspot count"</span>, format <span class="op">=</span> <span class="st">"%.0f"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="dna-sequence-alignment">DNA sequence alignment<a class="anchor" aria-label="anchor" href="#dna-sequence-alignment"></a>
</h2>
<p>This example visualizes pairwise alignment of CDS (coding sequence) of the gene <em>TP53</em> between human and mouse. The alignment was obtained by <a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi" class="external-link">blast</a>.</p>
<p>First I read the blast result and format it as two vectors of letters.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lines</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tp53_blast.txt"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="va">lines</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">subject</span> <span class="op">=</span> <span class="va">lines</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lines</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^\\S+\\s+\\S+\\s+|\\s+\\S+$"</span>, <span class="st">""</span>, <span class="va">query</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">query</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">query</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">subject</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"^\\S+\\s+\\S+\\s+|\\s+\\S+$"</span>, <span class="st">""</span>, <span class="va">subject</span><span class="op">)</span></span>
<span><span class="va">subject</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">subject</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">subject</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">subject</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The plot is mainly drawn with <code><a href="../reference/spiral_text.html">spiral_text()</a></code> and <code><a href="../reference/spiral_segments.html">spiral_segments()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"T"</span> <span class="op">=</span> <span class="fl">4</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"G"</span> <span class="op">=</span> <span class="fl">7</span>, <span class="st">"-"</span> <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">180</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">6</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="va">query</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, </span>
<span>    gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">query</span><span class="op">]</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"top"</span>,<span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="va">subject</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, </span>
<span>    gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">subject</span><span class="op">]</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">query</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.35</span>, <span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.65</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"#444444"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span>, <span class="fl">0.5</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"#888888"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">at</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">n</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="va">at</span>, <span class="fl">0.5</span>, pch <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">l</span> <span class="op">=</span> <span class="va">at</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">100</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="va">at</span><span class="op">[</span><span class="va">l</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">at</span><span class="op">[</span><span class="va">l</span><span class="op">]</span>, <span class="st">"bp"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    facing <span class="op">=</span> <span class="st">"inside"</span>, nice_facing<span class="op">=</span><span class="cn">T</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">6</span>, col <span class="op">=</span> <span class="st">"#444444"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-15-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="integrative-visualization-of-methylation-and-histone-modifications-for-bcat2">Integrative visualization of methylation and histone modifications for BCAT2<a class="anchor" aria-label="anchor" href="#integrative-visualization-of-methylation-and-histone-modifications-for-bcat2"></a>
</h2>
<p>This example visualizes DNA methylation and four histone modification signals along <em>BCAT2</em> gene. The data is from <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE16256" class="external-link">UCSD Human Reference Epigenome Mapping Project</a> and data for lung tissue is used.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"BCAT2_tracks.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize_by_gcoor.html">spiral_initialize_by_gcoor</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">3</span>,</span>
<span>    vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">exons</span> <span class="op">=</span> <span class="va">df_list</span><span class="op">$</span><span class="va">exons</span></span>
<span><span class="va">exons</span> <span class="op">=</span> <span class="va">exons</span><span class="op">[</span><span class="va">exons</span><span class="op">[</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">==</span> <span class="st">"exon"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.1</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">exons</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">0.1</span>, <span class="va">exons</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, <span class="fl">0.9</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="fl">49314286</span>, <span class="fl">0</span>, <span class="fl">49314286</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="fl">49314286</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">49314286</span> <span class="op">-</span> <span class="fl">200</span>, <span class="op">-</span><span class="fl">1</span>, arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49314286</span>, <span class="op">-</span><span class="fl">1</span>, <span class="st">"TSS"</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, facing <span class="op">=</span> <span class="st">"outside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="fl">49298318</span>, <span class="fl">0</span>, <span class="fl">49298318</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49298318</span>, <span class="op">-</span><span class="fl">1</span>, <span class="st">"TES"</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="fl">49298318</span>, <span class="op">-</span><span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meth</span> <span class="op">=</span> <span class="va">df_list</span><span class="op">$</span><span class="va">meth</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.13</span><span class="op">)</span></span>
<span><span class="va">meth_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_segments.html">spiral_segments</a></span><span class="op">(</span><span class="va">meth</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">0</span>, <span class="va">meth</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu">meth_col</span><span class="op">(</span><span class="va">meth</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Methylation"</span>, col_fun <span class="op">=</span> <span class="va">meth_col</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">mark</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"H3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df</span> <span class="op">=</span> <span class="va">df_list</span><span class="op">[[</span><span class="va">mark</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">i</span> <span class="op">=</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.13</span><span class="op">)</span></span>
<span>    <span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="../reference/spiral_horizon.html">spiral_horizon</a></span><span class="op">(</span> <span class="op">(</span><span class="va">df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, <span class="va">df</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span>, pos_fill <span class="op">=</span> <span class="va">i</span>,</span>
<span>        use_bars <span class="op">=</span> <span class="cn">TRUE</span>, bar_width <span class="op">=</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">df</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">lgd_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lgd_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/horizon_legend.html">horizon_legend</a></span><span class="op">(</span><span class="va">lt</span>, title <span class="op">=</span> <span class="va">mark</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_lines.html">spiral_lines</a></span><span class="op">(</span><span class="va">TRACK_META</span><span class="op">$</span><span class="va">xlim</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">at</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span>, <span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">=</span> <span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span>, <span class="va">df_list</span><span class="op">$</span><span class="va">range</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span><span class="op">)</span> <span class="op">-</span> <span class="fl">49314286</span><span class="op">)</span></span>
<span><span class="va">labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">labels</span><span class="op">/</span><span class="fl">1000</span>, <span class="st">"KB"</span><span class="op">)</span></span>
<span><span class="va">labels</span><span class="op">[</span><span class="va">labels</span> <span class="op">==</span> <span class="st">"11KB"</span><span class="op">]</span> <span class="op">=</span> <span class="st">""</span></span>
<span><span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span>at <span class="op">=</span> <span class="va">at</span>, labels <span class="op">=</span> <span class="va">labels</span>, labels_gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297318</span>, <span class="fl">0.5</span>, <span class="st">"Methylation"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297318</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me1"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297318</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me3"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297318</span>, <span class="fl">0.5</span>, <span class="st">"H3K9me3"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49297318</span>, <span class="fl">0.5</span>, <span class="st">"H3K27ac"</span>, hjust <span class="op">=</span> <span class="fl">0</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315286</span>, <span class="fl">0.5</span>, <span class="st">"Methylation"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315286</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me1"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315286</span>, <span class="fl">0.5</span>, <span class="st">"H3K4me3"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315286</span>, <span class="fl">0.5</span>, <span class="st">"H3K9me3"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">49315286</span>, <span class="fl">0.5</span>, <span class="st">"H3K27ac"</span>, hjust <span class="op">=</span> <span class="fl">1</span>, facing <span class="op">=</span> <span class="st">"inside"</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, track_index <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/packLegend.html" class="external-link">packLegend</a></span><span class="op">(</span>list <span class="op">=</span> <span class="va">lgd_list</span>, max_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"in"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="circadian-gene-expression">Circadian gene expression<a class="anchor" aria-label="anchor" href="#circadian-gene-expression"></a>
</h2>
<p>This example visualizes circadian expression for gene Elf1 in mouse. The data is from <a href="https://www.science.org/doi/10.1126/science.aaw7365" class="external-link">Ray et al., 2020</a>. Normally, circadian expression data has a period of 24 hours. In this dataset, gene expression was measures every 3 hours for continuous 3 days. Also in the data there are two categories: WT and KO.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># values are log(FPKM)</span></span>
<span><span class="va">expr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"circadian_expression_mouse_Elf1.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">expr</span></span></code></pre></div>
<pre><code><span><span class="co">##       WT_ex_vivo_CT00_FPKM       WT_ex_vivo_CT03_FPKM       WT_ex_vivo_CT06_FPKM </span></span>
<span><span class="co">##                   1.946163                   1.966772                   2.031689 </span></span>
<span><span class="co">##       WT_ex_vivo_CT09_FPKM       WT_ex_vivo_CT12_FPKM       WT_ex_vivo_CT15_FPKM </span></span>
<span><span class="co">##                   2.058403                   2.089375                   2.224578 </span></span>
<span><span class="co">##       WT_ex_vivo_CT18_FPKM       WT_ex_vivo_CT21_FPKM       WT_ex_vivo_CT24_FPKM </span></span>
<span><span class="co">##                   2.177284                   2.286159                   2.063952 </span></span>
<span><span class="co">##       WT_ex_vivo_CT27_FPKM       WT_ex_vivo_CT30_FPKM       WT_ex_vivo_CT33_FPKM </span></span>
<span><span class="co">##                   2.056942                   2.020091                   2.091957 </span></span>
<span><span class="co">##       WT_ex_vivo_CT36_FPKM       WT_ex_vivo_CT39_FPKM       WT_ex_vivo_CT42_FPKM </span></span>
<span><span class="co">##                   2.195589                   2.165829                   2.435471 </span></span>
<span><span class="co">##       WT_ex_vivo_CT45_FPKM       WT_ex_vivo_CT48_FPKM       WT_ex_vivo_CT51_FPKM </span></span>
<span><span class="co">##                   2.350413                   2.029327                   1.907440 </span></span>
<span><span class="co">##       WT_ex_vivo_CT54_FPKM       WT_ex_vivo_CT57_FPKM       WT_ex_vivo_CT60_FPKM </span></span>
<span><span class="co">##                   1.869779                   2.001830                   2.352460 </span></span>
<span><span class="co">##       WT_ex_vivo_CT63_FPKM       WT_ex_vivo_CT66_FPKM       WT_ex_vivo_CT69_FPKM </span></span>
<span><span class="co">##                   2.259880                   2.563833                   2.662139 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT00_FPKM KO_Bmal1_ex_vivo_CT03_FPKM KO_Bmal1_ex_vivo_CT06_FPKM </span></span>
<span><span class="co">##                   1.813244                   1.793085                   1.882293 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT09_FPKM KO_Bmal1_ex_vivo_CT12_FPKM KO_Bmal1_ex_vivo_CT15_FPKM </span></span>
<span><span class="co">##                   1.880257                   1.948317                   2.260520 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT18_FPKM KO_Bmal1_ex_vivo_CT21_FPKM KO_Bmal1_ex_vivo_CT24_FPKM </span></span>
<span><span class="co">##                   2.042636                   1.991640                   1.807574 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT27_FPKM KO_Bmal1_ex_vivo_CT30_FPKM KO_Bmal1_ex_vivo_CT33_FPKM </span></span>
<span><span class="co">##                   1.782811                   1.901610                   1.923029 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT36_FPKM KO_Bmal1_ex_vivo_CT39_FPKM KO_Bmal1_ex_vivo_CT42_FPKM </span></span>
<span><span class="co">##                   2.080510                   2.240497                   2.617009 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT45_FPKM KO_Bmal1_ex_vivo_CT48_FPKM KO_Bmal1_ex_vivo_CT51_FPKM </span></span>
<span><span class="co">##                   2.189481                   1.752573                   2.091201 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT54_FPKM KO_Bmal1_ex_vivo_CT57_FPKM KO_Bmal1_ex_vivo_CT60_FPKM </span></span>
<span><span class="co">##                   2.004804                   2.174539                   2.031771 </span></span>
<span><span class="co">## KO_Bmal1_ex_vivo_CT63_FPKM KO_Bmal1_ex_vivo_CT66_FPKM KO_Bmal1_ex_vivo_CT69_FPKM </span></span>
<span><span class="co">##                   2.607522                   2.616731                   2.201183</span></span></code></pre>
<p>Heatmap is used to visualize the data.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">69</span>, by <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">rg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span></span>
<span></span>
<span><span class="va">col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rg</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rg</span><span class="op">)</span>, <span class="va">rg</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"#F7F7F7"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">69</span><span class="op">)</span>, period <span class="op">=</span> <span class="fl">24</span>, polar_lines_by <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    vp_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"npc"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1.5</span>, <span class="fl">0</span>, <span class="va">t</span> <span class="op">+</span> <span class="fl">1.5</span>, <span class="fl">0.5</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">expr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_rect.html">spiral_rect</a></span><span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="va">t</span> <span class="op">+</span> <span class="fl">1.5</span>, <span class="fl">1</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/col.html" class="external-link">col</a></span><span class="op">(</span><span class="va">expr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">24</span> <span class="op">+</span> <span class="fl">24</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_axis.html">spiral_axis</a></span><span class="op">(</span>at <span class="op">=</span> <span class="va">t</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">t</span>, <span class="st">"h"</span><span class="op">)</span>, h <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">69</span> <span class="op">+</span> <span class="fl">1.6</span>, <span class="fl">0.25</span>, <span class="st">"WT"</span>, just <span class="op">=</span> <span class="st">"left"</span>, facing <span class="op">=</span> <span class="st">"outside"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_text.html">spiral_text</a></span><span class="op">(</span><span class="fl">69</span> <span class="op">+</span> <span class="fl">1.6</span>, <span class="fl">0.75</span>, <span class="st">"KO"</span>, just <span class="op">=</span> <span class="st">"left"</span>, facing <span class="op">=</span> <span class="st">"outside"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lgd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Legend.html" class="external-link">Legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"log(FPKM)"</span>, col_fun <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">lgd</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"npc"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>, just <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="github-commits">GitHub commits<a class="anchor" aria-label="anchor" href="#github-commits"></a>
</h2>
<p>This example visualizes my GitHub daily commits from 2013-04-18 to 2021-07-01. The data is retrieved by the following code:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GlobalOptions"</span>, <span class="st">"GetoptLong"</span>, <span class="st">"circlize"</span>, <span class="st">"bsub"</span>, <span class="st">"pkgndep"</span>, <span class="st">"ComplexHeatmap"</span>, <span class="st">"EnrichedHeatmap"</span>, </span>
<span>    <span class="st">"HilbertCurve"</span>, <span class="st">"gtrellis"</span>, <span class="st">"cola"</span>, <span class="st">"simplifyEnrichment"</span>, <span class="st">"InteractiveComplexHeatmap"</span>, <span class="st">"spiralize"</span>, <span class="st">"rGREAT"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_all</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>commits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, repo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="va">repos</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># go to each repo folder</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~/project/development/"</span>, <span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">pipe</a></span><span class="op">(</span><span class="st">"git log --date=short --pretty=format:%ad | sort | uniq -c"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"commits"</span>, <span class="st">"date"</span><span class="op">)</span></span>
<span>    <span class="va">df</span><span class="op">$</span><span class="va">repo</span> <span class="op">=</span> <span class="va">r</span></span>
<span></span>
<span>    <span class="va">df_all</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_all</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_all</span><span class="op">$</span><span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">df_all</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">start</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df_all</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">end</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_all</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">start</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">end</span> <span class="op">-</span> <span class="va">start</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">repos</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nl</span><span class="op">)</span> <span class="op">=</span> <span class="va">repos</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df_all</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/difftime.html" class="external-link">difftime</a></span><span class="op">(</span><span class="va">df_all</span><span class="op">[</span><span class="va">i</span>, <span class="st">"date"</span><span class="op">]</span>, <span class="va">start</span><span class="op">)</span>, <span class="st">"days"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="va">n</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">=</span> <span class="va">n</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">+</span> <span class="va">df_all</span><span class="op">[</span><span class="va">i</span>, <span class="st">"commits"</span><span class="op">]</span></span>
<span></span>
<span>    <span class="va">nl</span><span class="op">[[</span> <span class="va">df_all</span><span class="op">[</span><span class="va">i</span>, <span class="st">"repo"</span><span class="op">]</span> <span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">=</span> <span class="va">nl</span><span class="op">[[</span> <span class="va">df_all</span><span class="op">[</span><span class="va">i</span>, <span class="st">"repo"</span><span class="op">]</span> <span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span> <span class="op">+</span> <span class="va">df_all</span><span class="op">[</span><span class="va">i</span>, <span class="st">"commits"</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">d</span>, n <span class="op">=</span> <span class="va">n</span>, nl <span class="op">=</span> <span class="va">nl</span><span class="op">)</span></span></code></pre></div>
<p>Here <code>d</code> is a vector of dates, <code>n</code> is a vector of daily commits of all packages, and <code>nl</code> is a list of vectors of commits of individual packages.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"github_commits.rds"</span>, package <span class="op">=</span> <span class="st">"spiralize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="va">lt</span><span class="op">$</span><span class="va">d</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="va">lt</span><span class="op">$</span><span class="va">n</span></span>
<span><span class="va">nl</span> <span class="op">=</span> <span class="va">lt</span><span class="op">$</span><span class="va">nl</span></span></code></pre></div>
<p>I will use points to visualize commits. I first define a simple function to map between commits to point sizes.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calc_pt_size</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pt_size</span> <span class="op">=</span> <span class="va">x</span></span>
<span>    <span class="va">pt_size</span><span class="op">[</span><span class="va">pt_size</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">]</span> <span class="op">=</span> <span class="fl">20</span></span>
<span>    <span class="va">pt_size</span><span class="op">[</span><span class="va">pt_size</span> <span class="op">&lt;</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">pt_size</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="va">pt_size</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Next I make the plot for the total commits and commits for individual pacakges. It is actually very easy to see in which period the package was mostly actively developed.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">pl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pl</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span><span class="va">xlim</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">0.5</span>, pch <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu">calc_pt_size</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid.text</a></span><span class="op">(</span><span class="st">"All packages"</span>, x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">1</span>, just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nl</span>, <span class="va">sum</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pl</span><span class="op">[[</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nl</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/spiral_initialize_by_time.html">spiral_initialize_by_time</a></span><span class="op">(</span><span class="va">xlim</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="../reference/spiral_points.html">spiral_points</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">0.5</span>, pch <span class="op">=</span> <span class="fl">16</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu">calc_pt_size</span><span class="op">(</span><span class="va">nl</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">grid.text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nl</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, x <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">1</span>, just <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"left"</span>, <span class="st">"top"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">pl</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-22-1.png" width="1536" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="fill-spiral-tracks-with-images">Fill spiral tracks with images<a class="anchor" aria-label="anchor" href="#fill-spiral-tracks-with-images"></a>
</h2>
<p>The RData file <code>doodle.RData</code> returns the object <code>img_list</code> which contains raster objects for 32 images. First I merge them as a single image.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"doodle.RData"</span>, package <span class="op">=</span> <span class="st">"circlize"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">img_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/grDevices/as.raster.html" class="external-link">as.raster</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">106</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/as.raster.html" class="external-link">as.raster</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  106 4800</span></span></code></pre>
<p>Next simply call <code><a href="../reference/spiral_track.html">spiral_track()</a></code> with <code>facing = "curved_inside"</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"curve"</span>, start <span class="op">=</span> <span class="fl">180</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span>background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_raster.html">spiral_raster</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="va">img</span>, facing <span class="op">=</span> <span class="st">"curved_inside"</span><span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The second example is the spiralization of the masterpiece “清明上河图” (Along the River During the Qingming Festival, <a href="https://en.wikipedia.org/wiki/Along_the_River_During_the_Qingming_Festival" class="external-link uri">https://en.wikipedia.org/wiki/Along_the_River_During_the_Qingming_Festival</a>). There are several versions in history. Here I use the one recreated in the Qing dynasty which is brighter and more colorful. The file <code>Along_the_River_During_the_Qingming_Festival_(Qing_Court_Version).jpg</code> is downloaded from <a href="https://zh.wikipedia.org/wiki/%E6%B8%85%E6%98%8E%E4%B8%8A%E6%B2%B3%E5%9C%96#/media/File:Along_the_River_During_the_Qingming_Festival_(Qing_Court_Version).jpg" class="external-link uri">https://zh.wikipedia.org/wiki/%E6%B8%85%E6%98%8E%E4%B8%8A%E6%B2%B3%E5%9C%96#/media/File:Along_the_River_During_the_Qingming_Festival_(Qing_Court_Version).jpg</a>.</p>
<p>Note it takes very long time to generate this plot.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">image</span> <span class="op">=</span> <span class="st">"~/Downloads/Along_the_River_During_the_Qingming_Festival_(Qing_Court_Version).jpg"</span></span>
<span><span class="fu"><a href="../reference/spiral_initialize.html">spiral_initialize</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fl">180</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">3</span>, scale_by <span class="op">=</span> <span class="st">"curve"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_track.html">spiral_track</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/spiral_raster.html">spiral_raster</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="va">image</span>, facing <span class="op">=</span> <span class="st">"curved_inside"</span><span class="op">)</span></span></code></pre></div>
<p><img src="qing_ming_shang_he_tu_small.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="the-covid-19-daily-increase">The COVID-19 daily increase<a class="anchor" aria-label="anchor" href="#the-covid-19-daily-increase"></a>
</h2>
<p>The COVID-19 daily increase is basically a time series data, thus it is natural to visualize it via spirals. I have implemented it in a Shiny application (<a href="https://jokergoooo.shinyapps.io/covid19/" class="external-link uri">https://jokergoooo.shinyapps.io/covid19/</a>, not available any more). The source code for generating this app is avaiable at <a href="https://gist.github.com/jokergoo/fa39ee3dcf20cbc13a31bbe93c3498fb" class="external-link uri">https://gist.github.com/jokergoo/fa39ee3dcf20cbc13a31bbe93c3498fb</a>.</p>
<p><img src="https://user-images.githubusercontent.com/449218/154753102-d66b3588-eca1-471b-bdfe-2c147ed257f5.gif" width="100%"></p>
<script src="jquery.min.js"></script><script src="jquery.sticky.js"></script><script>
$(document).ready(function(){
    $("#TOC").sticky({
        topSpacing: 0,
        zIndex:1000    
    })
    $("#TOC").on("sticky-start", function() {

        $("<p style='font-size:1.2em; padding-left:4px;'><a id='TOC-click'>Table of Content</a></p>").insertBefore($("#TOC ul:first-child"));
        $("#TOC-click").hover(function() {
            $(this).css("color", "#0033dd").css("cursor", "pointer");
            $("#TOC").children().first().next().show();
            $("#TOC").hover(function() {
                $(this).children().first().next().show();
            }, function() {
                $(this).children().first().next().hide();
                $("body").off("hover", "#TOC");
            })
        }, function() {
            $(this).css("color", "#0033dd");
        })
        $("#TOC").children().first().next().hide();

    })
    $("#TOC").on("sticky-end", function() {
        $("#TOC").children().first().remove();
        $("#TOC").children().first().show();
    })
});
</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style>
</body>
</html>
